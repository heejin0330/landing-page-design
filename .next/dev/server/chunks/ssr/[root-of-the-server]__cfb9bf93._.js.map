{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/cording/landing-page-design/actions/gemini.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\r\n\r\ninterface ChatMessage {\r\n  role: \"user\" | \"assistant\";\r\n  content: string;\r\n}\r\n\r\ninterface ChatResponse {\r\n  success: boolean;\r\n  message?: string;\r\n  error?: string;\r\n}\r\n\r\nexport async function sendChatMessage(\r\n  message: string,\r\n  history: ChatMessage[] = []\r\n): Promise<ChatResponse> {\r\n  try {\r\n    const apiKey = process.env.GEMINI_API_KEY;\r\n\r\n    if (!apiKey) {\r\n      console.error(\"GEMINI_API_KEY가 설정되지 않았습니다.\");\r\n      return {\r\n        success: false,\r\n        error: \"서버 설정 오류: API 키가 없습니다.\",\r\n      };\r\n    }\r\n\r\n    const genAI = new GoogleGenerativeAI(apiKey);\r\n    const model = genAI.getGenerativeModel({ model: \"gemini-2.5-flash\" });\r\n\r\n    // 히스토리에서 초기 assistant 메시지 제외\r\n    // 첫 번째 메시지가 assistant인 경우 제외 (초기 인사 메시지)\r\n    const filteredHistory = history.filter((msg, index) => {\r\n      if (index === 0 && msg.role === \"assistant\") {\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n\r\n    // 채팅 히스토리를 Gemini 형식으로 변환\r\n    // 첫 번째 메시지는 반드시 user여야 함\r\n    const chatHistory = filteredHistory\r\n      .map((msg) => ({\r\n        role: msg.role === \"user\" ? \"user\" : \"model\",\r\n        parts: [{ text: msg.content }],\r\n      }))\r\n      .filter((msg, index) => {\r\n        // 첫 번째 메시지가 user가 아니면 제외\r\n        if (index === 0 && msg.role !== \"user\") {\r\n          return false;\r\n        }\r\n        return true;\r\n      });\r\n\r\n    // 채팅 시작 (히스토리가 있으면 전달, 없으면 빈 배열)\r\n    const chat = model.startChat({\r\n      history: chatHistory.length > 0 ? chatHistory : undefined,\r\n    });\r\n\r\n    // 메시지 전송 및 응답 받기\r\n    const result = await chat.sendMessage(message);\r\n    const response = await result.response;\r\n    const text = response.text();\r\n\r\n    return {\r\n      success: true,\r\n      message: text,\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Gemini API 오류:\", error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : \"알 수 없는 오류가 발생했습니다.\",\r\n    };\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;;;;AAaO,eAAe,gBACpB,OAAe,EACf,UAAyB,EAAE;IAE3B,IAAI;QACF,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;QAEzC,IAAI,CAAC,QAAQ;YACX,QAAQ,KAAK,CAAC;YACd,OAAO;gBACL,SAAS;gBACT,OAAO;YACT;QACF;QAEA,MAAM,QAAQ,IAAI,8PAAkB,CAAC;QACrC,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YAAE,OAAO;QAAmB;QAEnE,6BAA6B;QAC7B,yCAAyC;QACzC,MAAM,kBAAkB,QAAQ,MAAM,CAAC,CAAC,KAAK;YAC3C,IAAI,UAAU,KAAK,IAAI,IAAI,KAAK,aAAa;gBAC3C,OAAO;YACT;YACA,OAAO;QACT;QAEA,0BAA0B;QAC1B,yBAAyB;QACzB,MAAM,cAAc,gBACjB,GAAG,CAAC,CAAC,MAAQ,CAAC;gBACb,MAAM,IAAI,IAAI,KAAK,SAAS,SAAS;gBACrC,OAAO;oBAAC;wBAAE,MAAM,IAAI,OAAO;oBAAC;iBAAE;YAChC,CAAC,GACA,MAAM,CAAC,CAAC,KAAK;YACZ,yBAAyB;YACzB,IAAI,UAAU,KAAK,IAAI,IAAI,KAAK,QAAQ;gBACtC,OAAO;YACT;YACA,OAAO;QACT;QAEF,iCAAiC;QACjC,MAAM,OAAO,MAAM,SAAS,CAAC;YAC3B,SAAS,YAAY,MAAM,GAAG,IAAI,cAAc;QAClD;QAEA,iBAAiB;QACjB,MAAM,SAAS,MAAM,KAAK,WAAW,CAAC;QACtC,MAAM,WAAW,MAAM,OAAO,QAAQ;QACtC,MAAM,OAAO,SAAS,IAAI;QAE1B,OAAO;YACL,SAAS;YACT,SAAS;QACX;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kBAAkB;QAChC,OAAO;YACL,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF;;;IA/DsB;;AAAA,8WAAA"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///C:/cording/landing-page-design/actions/news.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport Parser from \"rss-parser\";\r\n\r\ninterface NewsItem {\r\n  id: string;\r\n  category: \"고교입시\" | \"마이스터고\" | \"특성화고\";\r\n  title: string;\r\n  summary: string;\r\n  date: string;\r\n  link: string;\r\n}\r\n\r\ninterface CollectNewsResult {\r\n  success: boolean;\r\n  count?: number;\r\n  error?: string;\r\n}\r\n\r\ninterface GetNewsResult {\r\n  success: boolean;\r\n  news?: NewsItem[];\r\n  error?: string;\r\n}\r\n\r\n// RSS 피드 URL 목록\r\nconst RSS_FEEDS = [\r\n  // 교육부 공식 RSS (예시 - 실제 URL로 변경 필요)\r\n  // \"https://www.moe.go.kr/rss/rss.jsp\",\r\n  // 연합뉴스 교육 섹션 (예시)\r\n  // \"https://www.yna.co.kr/rss/education.xml\",\r\n  // 뉴시스 교육 섹션 (예시)\r\n  // \"https://www.newsis.com/rss/education.xml\",\r\n];\r\n\r\n// 키워드 매칭 함수\r\nfunction categorizeNews(title: string, summary: string): \"고교입시\" | \"마이스터고\" | \"특성화고\" | null {\r\n  const text = (title + \" \" + summary).toLowerCase();\r\n  \r\n  const keywords = {\r\n    고교입시: [\"고교입시\", \"고등학교 입시\", \"입학전형\", \"학생부\", \"내신\", \"입시\", \"고입\"],\r\n    마이스터고: [\"마이스터고\", \"마이스터\", \"특성화고\", \"기술고\", \"전문계고\"],\r\n    특성화고: [\"특성화고\", \"특성화 고등학교\", \"전문계\", \"실업계\", \"상업고\", \"공업고\", \"농업고\"],\r\n  };\r\n\r\n  // 마이스터고 키워드가 있으면 마이스터고로 분류\r\n  if (keywords.마이스터고.some((kw) => text.includes(kw))) {\r\n    return \"마이스터고\";\r\n  }\r\n  \r\n  // 특성화고 키워드가 있으면 특성화고로 분류\r\n  if (keywords.특성화고.some((kw) => text.includes(kw))) {\r\n    return \"특성화고\";\r\n  }\r\n  \r\n  // 고교입시 키워드가 있으면 고교입시로 분류\r\n  if (keywords.고교입시.some((kw) => text.includes(kw))) {\r\n    return \"고교입시\";\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n// Notion에 뉴스 저장\r\nasync function saveNewsToNotion(news: {\r\n  title: string;\r\n  category: string;\r\n  summary: string;\r\n  link: string;\r\n  date: string;\r\n}): Promise<boolean> {\r\n  try {\r\n    const notionApiKey = process.env.NOTION_API_KEY;\r\n    const notionNewsDatabaseId = process.env.NOTION_NEWS_DATABASE_ID;\r\n\r\n    if (!notionApiKey || !notionNewsDatabaseId) {\r\n      console.error(\"Notion API 키 또는 데이터베이스 ID가 설정되지 않았습니다.\");\r\n      return false;\r\n    }\r\n\r\n    const properties: Record<string, any> = {\r\n      제목: {\r\n        title: [\r\n          {\r\n            text: {\r\n              content: news.title,\r\n            },\r\n          },\r\n        ],\r\n      },\r\n      카테고리: {\r\n        select: {\r\n          name: news.category,\r\n        },\r\n      },\r\n      요약: {\r\n        rich_text: [\r\n          {\r\n            text: {\r\n              content: news.summary,\r\n            },\r\n          },\r\n        ],\r\n      },\r\n      링크: {\r\n        url: news.link,\r\n      },\r\n      날짜: {\r\n        date: {\r\n          start: news.date,\r\n        },\r\n      },\r\n      수집일시: {\r\n        date: {\r\n          start: new Date().toISOString(),\r\n        },\r\n      },\r\n    };\r\n\r\n    const response = await fetch(\"https://api.notion.com/v1/pages\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Bearer ${notionApiKey}`,\r\n        \"Content-Type\": \"application/json\",\r\n        \"Notion-Version\": \"2022-06-28\",\r\n      },\r\n      body: JSON.stringify({\r\n        parent: {\r\n          database_id: notionNewsDatabaseId,\r\n        },\r\n        properties,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      console.error(\"Notion API 오류:\", errorData);\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  } catch (error) {\r\n    console.error(\"뉴스 저장 오류:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// 중복 체크 (링크 기준)\r\nasync function checkDuplicate(link: string): Promise<boolean> {\r\n  try {\r\n    const notionApiKey = process.env.NOTION_API_KEY;\r\n    const notionNewsDatabaseId = process.env.NOTION_NEWS_DATABASE_ID;\r\n\r\n    if (!notionApiKey || !notionNewsDatabaseId) {\r\n      return false;\r\n    }\r\n\r\n    const response = await fetch(\r\n      `https://api.notion.com/v1/databases/${notionNewsDatabaseId}/query`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${notionApiKey}`,\r\n          \"Content-Type\": \"application/json\",\r\n          \"Notion-Version\": \"2022-06-28\",\r\n        },\r\n        body: JSON.stringify({\r\n          filter: {\r\n            property: \"링크\",\r\n            url: {\r\n              equals: link,\r\n            },\r\n          },\r\n        }),\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      return false;\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.results && data.results.length > 0;\r\n  } catch (error) {\r\n    console.error(\"중복 체크 오류:\", error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// 뉴스 수집 서버 액션\r\nexport async function collectNews(): Promise<CollectNewsResult> {\r\n  try {\r\n    const notionApiKey = process.env.NOTION_API_KEY;\r\n    const notionNewsDatabaseId = process.env.NOTION_NEWS_DATABASE_ID;\r\n\r\n    if (!notionApiKey || !notionNewsDatabaseId) {\r\n      return {\r\n        success: false,\r\n        error: \"Notion API 키 또는 데이터베이스 ID가 설정되지 않았습니다.\",\r\n      };\r\n    }\r\n\r\n    if (RSS_FEEDS.length === 0) {\r\n      return {\r\n        success: false,\r\n        error: \"RSS 피드 URL이 설정되지 않았습니다.\",\r\n      };\r\n    }\r\n\r\n    const parser = new Parser();\r\n    let collectedCount = 0;\r\n\r\n    // 각 RSS 피드에서 뉴스 수집\r\n    for (const feedUrl of RSS_FEEDS) {\r\n      try {\r\n        const feed = await parser.parseURL(feedUrl);\r\n\r\n        for (const item of feed.items || []) {\r\n          // 카테고리 분류\r\n          const category = categorizeNews(item.title || \"\", item.contentSnippet || item.content || \"\");\r\n          \r\n          if (!category) {\r\n            continue; // 관련 없는 뉴스는 건너뛰기\r\n          }\r\n\r\n          // 중복 체크\r\n          const link = item.link || \"\";\r\n          if (!link) {\r\n            continue;\r\n          }\r\n\r\n          const isDuplicate = await checkDuplicate(link);\r\n          if (isDuplicate) {\r\n            continue; // 이미 저장된 뉴스는 건너뛰기\r\n          }\r\n\r\n          // 뉴스 저장\r\n          const summary = item.contentSnippet || item.content || item.title || \"\";\r\n          const date = item.pubDate ? new Date(item.pubDate).toISOString().split(\"T\")[0] : new Date().toISOString().split(\"T\")[0];\r\n\r\n          const saved = await saveNewsToNotion({\r\n            title: item.title || \"\",\r\n            category,\r\n            summary: summary.substring(0, 500), // 요약 길이 제한\r\n            link,\r\n            date,\r\n          });\r\n\r\n          if (saved) {\r\n            collectedCount++;\r\n          }\r\n\r\n          // API 호출 제한을 고려하여 약간의 지연\r\n          await new Promise((resolve) => setTimeout(resolve, 100));\r\n        }\r\n      } catch (error) {\r\n        console.error(`RSS 피드 파싱 오류 (${feedUrl}):`, error);\r\n        continue;\r\n      }\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      count: collectedCount,\r\n    };\r\n  } catch (error) {\r\n    console.error(\"뉴스 수집 오류:\", error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : \"알 수 없는 오류가 발생했습니다.\",\r\n    };\r\n  }\r\n}\r\n\r\n// 뉴스 조회 서버 액션\r\nexport async function getNews(limit: number = 6): Promise<GetNewsResult> {\r\n  try {\r\n    const notionApiKey = process.env.NOTION_API_KEY;\r\n    const notionNewsDatabaseId = process.env.NOTION_NEWS_DATABASE_ID;\r\n\r\n    if (!notionApiKey || !notionNewsDatabaseId) {\r\n      return {\r\n        success: false,\r\n        error: \"Notion API 키 또는 데이터베이스 ID가 설정되지 않았습니다.\",\r\n      };\r\n    }\r\n\r\n    const response = await fetch(\r\n      `https://api.notion.com/v1/databases/${notionNewsDatabaseId}/query`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${notionApiKey}`,\r\n          \"Content-Type\": \"application/json\",\r\n          \"Notion-Version\": \"2022-06-28\",\r\n        },\r\n        body: JSON.stringify({\r\n          sorts: [\r\n            {\r\n              property: \"날짜\",\r\n              direction: \"descending\",\r\n            },\r\n          ],\r\n          page_size: limit,\r\n        }),\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({}));\r\n      console.error(\"Notion API 오류:\", errorData);\r\n      return {\r\n        success: false,\r\n        error: \"뉴스를 불러오는 중 오류가 발생했습니다.\",\r\n      };\r\n    }\r\n\r\n    const data = await response.json();\r\n    const newsItems: NewsItem[] = data.results.map((page: any) => {\r\n      const props = page.properties;\r\n      return {\r\n        id: page.id,\r\n        category: props.카테고리?.select?.name || \"고교입시\",\r\n        title: props.제목?.title?.[0]?.text?.content || \"\",\r\n        summary: props.요약?.rich_text?.[0]?.text?.content || \"\",\r\n        date: props.날짜?.date?.start || \"\",\r\n        link: props.링크?.url || \"#\",\r\n      };\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      news: newsItems,\r\n    };\r\n  } catch (error) {\r\n    console.error(\"뉴스 조회 오류:\", error);\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : \"알 수 없는 오류가 발생했습니다.\",\r\n    };\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 425, "column": 0}, "map": {"version":3,"sources":["file:///C:/cording/landing-page-design/actions/notion.ts"],"sourcesContent":["\"use server\";\n\ninterface SubmitWaitlistFormResult {\n  success: boolean;\n  error?: string;\n}\n\ninterface LoginResult {\n  success: boolean;\n  error?: string;\n  userType?: string;\n}\n\nexport async function submitWaitlistForm(\n  name: string,\n  email: string,\n  phone: string,\n  userType?: string\n): Promise<SubmitWaitlistFormResult> {\n  try {\n    const notionApiKey = process.env.NOTION_API_KEY;\n    const notionDatabaseId = process.env.NOTION_DATABASE_ID;\n\n    // 환경변수 검증\n    if (!notionApiKey) {\n      console.error(\"NOTION_API_KEY가 설정되지 않았습니다.\");\n      return {\n        success: false,\n        error: \"서버 설정 오류: API 키가 없습니다.\",\n      };\n    }\n\n    if (!notionDatabaseId) {\n      console.error(\"NOTION_DATABASE_ID가 설정되지 않았습니다.\");\n      return {\n        success: false,\n        error: \"서버 설정 오류: 데이터베이스 ID가 없습니다.\",\n      };\n    }\n\n    // 기본 속성 구성\n    const properties: Record<string, any> = {\n      이름: {\n        title: [\n          {\n            text: {\n              content: name,\n            },\n          },\n        ],\n      },\n      이메일: {\n        email: email,\n      },\n      전화번호: {\n        phone_number: phone,\n      },\n    };\n\n    // 사용자유형이 있으면 속성에 추가\n    // 노션 데이터베이스에 속성이 없으면 오류가 발생할 수 있으므로\n    // 오류 발생 시 사용자유형 없이 재시도\n    if (userType) {\n      properties.사용자유형 = {\n        select: {\n          name: userType,\n        },\n      };\n    }\n\n    // Notion API 호출\n    const response = await fetch(\"https://api.notion.com/v1/pages\", {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${notionApiKey}`,\n        \"Content-Type\": \"application/json\",\n        \"Notion-Version\": \"2022-06-28\",\n      },\n      body: JSON.stringify({\n        parent: {\n          database_id: notionDatabaseId,\n        },\n        properties,\n      }),\n    });\n\n    // 응답 처리\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      console.error(\"Notion API 오류 응답:\", {\n        status: response.status,\n        statusText: response.statusText,\n        error: errorData,\n      });\n\n      // 사용자유형 속성 오류인 경우, 사용자유형 없이 재시도\n      if (\n        userType &&\n        (errorData.message?.includes(\"사용자유형\") ||\n          errorData.message?.includes(\"is not a property\"))\n      ) {\n        console.log(\"사용자유형 속성이 없어 기본 속성만으로 저장 시도\");\n        const propertiesWithoutUserType: Record<string, any> = {\n          이름: {\n            title: [\n              {\n                text: {\n                  content: name,\n                },\n              },\n            ],\n          },\n          이메일: {\n            email: email,\n          },\n          전화번호: {\n            phone_number: phone,\n          },\n        };\n\n        const retryResponse = await fetch(\"https://api.notion.com/v1/pages\", {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${notionApiKey}`,\n            \"Content-Type\": \"application/json\",\n            \"Notion-Version\": \"2022-06-28\",\n          },\n          body: JSON.stringify({\n            parent: {\n              database_id: notionDatabaseId,\n            },\n            properties: propertiesWithoutUserType,\n          }),\n        });\n\n        if (retryResponse.ok) {\n          const retryResult = await retryResponse.json().catch(() => null);\n          if (retryResult) {\n            console.log(\n              \"사용자유형 없이 데이터베이스에 성공적으로 저장되었습니다:\",\n              retryResult.id\n            );\n          }\n          return {\n            success: true,\n          };\n        }\n      }\n\n      // 에러 메시지 추출\n      let errorMessage = `API 오류 (${response.status})`;\n      if (errorData.message) {\n        errorMessage = errorData.message;\n      } else if (errorData.code) {\n        errorMessage = `오류 코드: ${errorData.code}`;\n      }\n\n      return {\n        success: false,\n        error: errorMessage,\n      };\n    }\n\n    // 성공 응답 확인\n    const result = await response.json().catch(() => null);\n    if (result) {\n      console.log(\n        \"Notion 데이터베이스에 성공적으로 저장되었습니다:\",\n        result.id\n      );\n    }\n\n    return {\n      success: true,\n    };\n  } catch (error) {\n    console.error(\"폼 제출 중 예외 발생:\", error);\n    return {\n      success: false,\n      error:\n        error instanceof Error\n          ? error.message\n          : \"네트워크 오류가 발생했습니다. 다시 시도해주세요.\",\n    };\n  }\n}\n\nexport async function verifyLogin(\n  name: string,\n  email: string,\n  phone: string\n): Promise<LoginResult> {\n  try {\n    const notionApiKey = process.env.NOTION_API_KEY;\n    const notionDatabaseId = process.env.NOTION_DATABASE_ID;\n\n    // 환경변수 검증\n    if (!notionApiKey) {\n      console.error(\"NOTION_API_KEY가 설정되지 않았습니다.\");\n      return {\n        success: false,\n        error: \"서버 설정 오류: API 키가 없습니다.\",\n      };\n    }\n\n    if (!notionDatabaseId) {\n      console.error(\"NOTION_DATABASE_ID가 설정되지 않았습니다.\");\n      return {\n        success: false,\n        error: \"서버 설정 오류: 데이터베이스 ID가 없습니다.\",\n      };\n    }\n\n    // Notion API로 데이터베이스 쿼리\n    const response = await fetch(\n      `https://api.notion.com/v1/databases/${notionDatabaseId}/query`,\n      {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${notionApiKey}`,\n          \"Content-Type\": \"application/json\",\n          \"Notion-Version\": \"2022-06-28\",\n        },\n        body: JSON.stringify({\n          filter: {\n            and: [\n              {\n                property: \"이름\",\n                title: {\n                  contains: name,\n                },\n              },\n              {\n                property: \"이메일\",\n                email: {\n                  equals: email,\n                },\n              },\n              {\n                property: \"전화번호\",\n                phone_number: {\n                  equals: phone,\n                },\n              },\n            ],\n          },\n        }),\n      }\n    );\n\n    // 응답 처리\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      console.error(\"Notion API 오류 응답:\", {\n        status: response.status,\n        statusText: response.statusText,\n        error: errorData,\n      });\n\n      return {\n        success: false,\n        error: \"로그인 확인 중 오류가 발생했습니다.\",\n      };\n    }\n\n    const result = await response.json().catch(() => null);\n\n    if (!result || !result.results || result.results.length === 0) {\n      return {\n        success: false,\n        error: \"일치하는 사용자 정보를 찾을 수 없습니다.\",\n      };\n    }\n\n    // 모든 결과를 확인하여 정확히 일치하는 사용자 찾기\n    for (const user of result.results) {\n      const userName = user.properties?.이름?.title?.[0]?.text?.content || \"\";\n      const userEmail = user.properties?.이메일?.email || \"\";\n      const userPhone = user.properties?.전화번호?.phone_number || \"\";\n\n      // 정확히 일치하는지 확인 (contains로 필터링했지만 정확한 일치 확인)\n      if (userName === name && userEmail === email && userPhone === phone) {\n        const userType = user.properties?.사용자유형?.select?.name || undefined;\n\n        return {\n          success: true,\n          userType,\n        };\n      }\n    }\n\n    // 필터링된 결과가 있지만 정확히 일치하지 않음\n    return {\n      success: false,\n      error: \"일치하는 사용자 정보를 찾을 수 없습니다.\",\n    };\n  } catch (error) {\n    console.error(\"로그인 검증 중 예외 발생:\", error);\n    return {\n      success: false,\n      error:\n        error instanceof Error\n          ? error.message\n          : \"네트워크 오류가 발생했습니다. 다시 시도해주세요.\",\n    };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 692, "column": 0}, "map": {"version":3,"sources":["file:///C:/cording/landing-page-design/lib/school-data.ts"],"sourcesContent":["// 관심사 목록\r\nexport const INTERESTS = [\r\n  \"IT/소프트웨어\",\r\n  \"요리/제과\",\r\n  \"자동차/기계\",\r\n  \"건축/인테리어\",\r\n  \"디자인/미술\",\r\n  \"패션/뷰티\",\r\n  \"항공/조선\",\r\n  \"전기/전자\",\r\n  \"금융/회계\",\r\n  \"의료/간호\",\r\n  \"농업/축산\",\r\n  \"해양/수산\",\r\n  \"경영/마케팅\",\r\n  \"호텔/관광\",\r\n  \"스포츠/레크리에이션\",\r\n] as const;\r\n\r\nexport type Interest = typeof INTERESTS[number];\r\n\r\n// 지역 목록 (시/도)\r\nexport const REGIONS = [\r\n  { value: \"서울\", label: \"서울특별시\" },\r\n  { value: \"부산\", label: \"부산광역시\" },\r\n  { value: \"대구\", label: \"대구광역시\" },\r\n  { value: \"인천\", label: \"인천광역시\" },\r\n  { value: \"광주\", label: \"광주광역시\" },\r\n  { value: \"대전\", label: \"대전광역시\" },\r\n  { value: \"울산\", label: \"울산광역시\" },\r\n  { value: \"세종\", label: \"세종특별자치시\" },\r\n  { value: \"경기\", label: \"경기도\" },\r\n  { value: \"강원\", label: \"강원특별자치도\" },\r\n  { value: \"충북\", label: \"충청북도\" },\r\n  { value: \"충남\", label: \"충청남도\" },\r\n  { value: \"전북\", label: \"전북특별자치도\" },\r\n  { value: \"전남\", label: \"전라남도\" },\r\n  { value: \"경북\", label: \"경상북도\" },\r\n  { value: \"경남\", label: \"경상남도\" },\r\n  { value: \"제주\", label: \"제주특별자치도\" },\r\n] as const;\r\n\r\n// 관심사와 학과(전공) 매핑\r\nexport const INTEREST_TO_MAJOR_MAPPING: Record<Interest, string[]> = {\r\n  \"IT/소프트웨어\": [\r\n    \"정보기술\",\r\n    \"소프트웨어\",\r\n    \"컴퓨터\",\r\n    \"IT\",\r\n    \"정보통신\",\r\n    \"게임\",\r\n    \"웹\",\r\n    \"모바일\",\r\n    \"프로그래밍\",\r\n    \"네트워크\",\r\n  ],\r\n  \"요리/제과\": [\r\n    \"조리\",\r\n    \"제과제빵\",\r\n    \"한식\",\r\n    \"양식\",\r\n    \"중식\",\r\n    \"일식\",\r\n    \"제과\",\r\n    \"제빵\",\r\n    \"식품\",\r\n    \"외식\",\r\n  ],\r\n  \"자동차/기계\": [\r\n    \"자동차\",\r\n    \"기계\",\r\n    \"기계공학\",\r\n    \"자동차정비\",\r\n    \"메카트로닉스\",\r\n    \"산업기계\",\r\n    \"생산기계\",\r\n  ],\r\n  \"건축/인테리어\": [\r\n    \"건축\",\r\n    \"인테리어\",\r\n    \"건축설계\",\r\n    \"실내건축\",\r\n    \"건축공학\",\r\n    \"목공\",\r\n    \"가구\",\r\n  ],\r\n  \"디자인/미술\": [\r\n    \"디자인\",\r\n    \"미술\",\r\n    \"시각디자인\",\r\n    \"산업디자인\",\r\n    \"영상디자인\",\r\n    \"애니메이션\",\r\n    \"만화\",\r\n  ],\r\n  \"패션/뷰티\": [\r\n    \"패션\",\r\n    \"의상\",\r\n    \"뷰티\",\r\n    \"미용\",\r\n    \"화장품\",\r\n    \"섬유\",\r\n    \"의류\",\r\n  ],\r\n  \"항공/조선\": [\r\n    \"항공\",\r\n    \"조선\",\r\n    \"항공정비\",\r\n    \"항공기계\",\r\n    \"조선공학\",\r\n    \"선박\",\r\n  ],\r\n  \"전기/전자\": [\r\n    \"전기\",\r\n    \"전자\",\r\n    \"전기공학\",\r\n    \"전자공학\",\r\n    \"전기전자\",\r\n    \"전기설비\",\r\n  ],\r\n  \"금융/회계\": [\r\n    \"금융\",\r\n    \"회계\",\r\n    \"경영\",\r\n    \"세무\",\r\n    \"금융정보\",\r\n    \"회계정보\",\r\n  ],\r\n  \"의료/간호\": [\r\n    \"의료\",\r\n    \"간호\",\r\n    \"보건\",\r\n    \"의료정보\",\r\n    \"의료기기\",\r\n  ],\r\n  \"농업/축산\": [\r\n    \"농업\",\r\n    \"축산\",\r\n    \"원예\",\r\n    \"축산경영\",\r\n    \"농업경영\",\r\n  ],\r\n  \"해양/수산\": [\r\n    \"해양\",\r\n    \"수산\",\r\n    \"해양공학\",\r\n    \"수산경영\",\r\n    \"어업\",\r\n  ],\r\n  \"경영/마케팅\": [\r\n    \"경영\",\r\n    \"마케팅\",\r\n    \"유통\",\r\n    \"물류\",\r\n    \"경영정보\",\r\n  ],\r\n  \"호텔/관광\": [\r\n    \"호텔\",\r\n    \"관광\",\r\n    \"레저\",\r\n    \"여행\",\r\n    \"서비스\",\r\n  ],\r\n  \"스포츠/레크리에이션\": [\r\n    \"스포츠\",\r\n    \"레크리에이션\",\r\n    \"체육\",\r\n    \"운동\",\r\n  ],\r\n};\r\n\r\n// 관심사와 학과 매칭 함수\r\nexport function matchInterestToMajor(interest: Interest, major: string): boolean {\r\n  const keywords = INTEREST_TO_MAJOR_MAPPING[interest] || [];\r\n  const majorLower = major.toLowerCase();\r\n  \r\n  return keywords.some((keyword) => majorLower.includes(keyword.toLowerCase()));\r\n}\r\n\r\n"],"names":[],"mappings":"AAAA,SAAS;;;;;;;;;;;AACF,MAAM,YAAY;IACvB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAKM,MAAM,UAAU;IACrB;QAAE,OAAO;QAAM,OAAO;IAAQ;IAC9B;QAAE,OAAO;QAAM,OAAO;IAAQ;IAC9B;QAAE,OAAO;QAAM,OAAO;IAAQ;IAC9B;QAAE,OAAO;QAAM,OAAO;IAAQ;IAC9B;QAAE,OAAO;QAAM,OAAO;IAAQ;IAC9B;QAAE,OAAO;QAAM,OAAO;IAAQ;IAC9B;QAAE,OAAO;QAAM,OAAO;IAAQ;IAC9B;QAAE,OAAO;QAAM,OAAO;IAAU;IAChC;QAAE,OAAO;QAAM,OAAO;IAAM;IAC5B;QAAE,OAAO;QAAM,OAAO;IAAU;IAChC;QAAE,OAAO;QAAM,OAAO;IAAO;IAC7B;QAAE,OAAO;QAAM,OAAO;IAAO;IAC7B;QAAE,OAAO;QAAM,OAAO;IAAU;IAChC;QAAE,OAAO;QAAM,OAAO;IAAO;IAC7B;QAAE,OAAO;QAAM,OAAO;IAAO;IAC7B;QAAE,OAAO;QAAM,OAAO;IAAO;IAC7B;QAAE,OAAO;QAAM,OAAO;IAAU;CACjC;AAGM,MAAM,4BAAwD;IACnE,YAAY;QACV;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,UAAU;QACR;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,WAAW;QACT;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,UAAU;QACR;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;KACD;IACD,UAAU;QACR;QACA;QACA;QACA;QACA;KACD;IACD,SAAS;QACP;QACA;QACA;QACA;QACA;KACD;IACD,cAAc;QACZ;QACA;QACA;QACA;KACD;AACH;AAGO,SAAS,qBAAqB,QAAkB,EAAE,KAAa;IACpE,MAAM,WAAW,yBAAyB,CAAC,SAAS,IAAI,EAAE;IAC1D,MAAM,aAAa,MAAM,WAAW;IAEpC,OAAO,SAAS,IAAI,CAAC,CAAC,UAAY,WAAW,QAAQ,CAAC,QAAQ,WAAW;AAC3E"}},
    {"offset": {"line": 926, "column": 0}, "map": {"version":3,"sources":["file:///C:/cording/landing-page-design/actions/school.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport * as XLSX from \"xlsx\";\r\nimport { readFileSync } from \"fs\";\r\nimport { join } from \"path\";\r\nimport { matchInterestToMajor, type Interest } from \"@/lib/school-data\";\r\n\r\nexport interface School {\r\n  id: string;\r\n  name: string;\r\n  type: \"특성화고\" | \"마이스터고\";\r\n  region: string; // 시/도\r\n  district?: string; // 시/군/구\r\n  educationOffice?: string; // 교육청\r\n  majors: string[]; // 과/전공 목록\r\n  hifiveLink: string;\r\n  homepage?: string; // 학교 홈페이지 URL\r\n  matchScore?: number; // 적합도 점수\r\n}\r\n\r\ninterface LoadSchoolDataResult {\r\n  success: boolean;\r\n  schools?: School[];\r\n  error?: string;\r\n}\r\n\r\ninterface MatchSchoolsResult {\r\n  success: boolean;\r\n  schools?: School[];\r\n  error?: string;\r\n}\r\n\r\n// 엑셀 파일에서 학교 데이터 로드\r\nexport async function loadSchoolDataFromExcel(): Promise<LoadSchoolDataResult> {\r\n  try {\r\n    // 엑셀 파일 경로 (public 폴더에 저장된 파일)\r\n    const filePath = join(process.cwd(), \"public\", \"data\", \"school-list.xls\");\r\n\r\n    // 파일이 없으면 에러 반환\r\n    try {\r\n      const fileBuffer = readFileSync(filePath);\r\n      const workbook = XLSX.read(fileBuffer, { type: \"buffer\" });\r\n      const sheetName = workbook.SheetNames[0];\r\n      const worksheet = workbook.Sheets[sheetName];\r\n      const data = XLSX.utils.sheet_to_json(worksheet) as any[];\r\n\r\n      // 데이터 변환 및 정규화\r\n      const schools: School[] = data\r\n        .map((row, index) => {\r\n          const schoolName = row[\"학교명\"] || \"\";\r\n          const schoolType = row[\"학교유형\"] || \"\";\r\n          const educationOffice = row[\"교육청\"] || \"\";\r\n          const majorType = row[\"학과유형\"] || \"\";\r\n          const homepage =\r\n            row[\"홈페이지\"] || row[\"학교홈페이지\"] || row[\"웹사이트\"] || \"\";\r\n\r\n          // 교육청에서 지역 추출\r\n          const region = extractRegionFromEducationOffice(educationOffice);\r\n\r\n          // 학교 유형 판단\r\n          const type: \"특성화고\" | \"마이스터고\" = schoolType.includes(\r\n            \"마이스터\"\r\n          )\r\n            ? \"마이스터고\"\r\n            : \"특성화고\";\r\n\r\n          // 홈페이지 URL 정규화 (http:// 또는 https://가 없으면 추가)\r\n          let normalizedHomepage = homepage;\r\n          if (\r\n            homepage &&\r\n            !homepage.startsWith(\"http://\") &&\r\n            !homepage.startsWith(\"https://\")\r\n          ) {\r\n            normalizedHomepage = `http://${homepage}`;\r\n          }\r\n\r\n          const school: School = {\r\n            id: `school-${index}`,\r\n            name: schoolName,\r\n            type,\r\n            region,\r\n            educationOffice,\r\n            majors: parseMajors(majorType),\r\n            hifiveLink: `https://www.hifive.go.kr/stats/schList.do?rootMenuId=01&menuId=010203&schoolName=${encodeURIComponent(\r\n              schoolName\r\n            )}`,\r\n            homepage: normalizedHomepage || undefined,\r\n          };\r\n\r\n          return school;\r\n        })\r\n        .filter((school) => school.name && school.region); // 유효한 데이터만 필터링\r\n\r\n      return {\r\n        success: true,\r\n        schools,\r\n      };\r\n    } catch (fileError) {\r\n      return {\r\n        success: false,\r\n        error: `엑셀 파일을 읽을 수 없습니다. 파일 경로를 확인하세요: ${filePath}`,\r\n      };\r\n    }\r\n  } catch (error) {\r\n    console.error(\"학교 데이터 로드 오류:\", error);\r\n    return {\r\n      success: false,\r\n      error:\r\n        error instanceof Error\r\n          ? error.message\r\n          : \"알 수 없는 오류가 발생했습니다.\",\r\n    };\r\n  }\r\n}\r\n\r\n// 교육청명에서 지역 추출\r\nfunction extractRegionFromEducationOffice(educationOffice: string): string {\r\n  if (!educationOffice) return \"\";\r\n\r\n  // 교육청명에서 지역 추출\r\n  // 예: \"서울특별시교육청\" -> \"서울\", \"경기도교육청\" -> \"경기\"\r\n  const regionMap: Record<string, string> = {\r\n    서울특별시교육청: \"서울\",\r\n    부산광역시교육청: \"부산\",\r\n    대구광역시교육청: \"대구\",\r\n    인천광역시교육청: \"인천\",\r\n    광주광역시교육청: \"광주\",\r\n    대전광역시교육청: \"대전\",\r\n    울산광역시교육청: \"울산\",\r\n    세종특별자치시교육청: \"세종\",\r\n    경기도교육청: \"경기\",\r\n    강원특별자치도교육청: \"강원\",\r\n    충청북도교육청: \"충북\",\r\n    충청남도교육청: \"충남\",\r\n    전북특별자치도교육청: \"전북\",\r\n    전라남도교육청: \"전남\",\r\n    경상북도교육청: \"경북\",\r\n    경상남도교육청: \"경남\",\r\n    제주특별자치도교육청: \"제주\",\r\n  };\r\n\r\n  // 정확한 매칭 시도\r\n  if (regionMap[educationOffice]) {\r\n    return regionMap[educationOffice];\r\n  }\r\n\r\n  // 부분 매칭 시도\r\n  for (const [key, value] of Object.entries(regionMap)) {\r\n    if (educationOffice.includes(key.replace(\"교육청\", \"\"))) {\r\n      return value;\r\n    }\r\n  }\r\n\r\n  // 매칭 실패 시 원본 반환 (빈 문자열)\r\n  return \"\";\r\n}\r\n\r\n// 학과 문자열 파싱 (쉼표, 슬래시 등으로 구분된 문자열을 배열로 변환)\r\nfunction parseMajors(majorString: string): string[] {\r\n  if (!majorString) return [];\r\n\r\n  return majorString\r\n    .split(/[,/|]/)\r\n    .map((major) => major.trim())\r\n    .filter((major) => major.length > 0);\r\n}\r\n\r\n// 학교 매칭 알고리즘\r\nexport async function matchSchools(params: {\r\n  interests: [Interest, Interest?, Interest?]; // 1-3순위 관심사\r\n  region: string; // 희망 지역\r\n}): Promise<MatchSchoolsResult> {\r\n  try {\r\n    // 학교 데이터 로드\r\n    const dataResult = await loadSchoolDataFromExcel();\r\n\r\n    if (!dataResult.success || !dataResult.schools) {\r\n      return {\r\n        success: false,\r\n        error: dataResult.error || \"학교 데이터를 불러올 수 없습니다.\",\r\n      };\r\n    }\r\n\r\n    const schools = dataResult.schools;\r\n\r\n    // 매칭 점수 계산\r\n    const scoredSchools: School[] = schools.map((school) => {\r\n      let score = 0;\r\n\r\n      // 관심사 매칭 점수 계산\r\n      params.interests.forEach((interest, index) => {\r\n        if (!interest) return;\r\n\r\n        const weight = [3, 2, 1][index]; // 1순위: 3점, 2순위: 2점, 3순위: 1점\r\n\r\n        // 학교의 학과 중 하나라도 관심사와 매칭되면 점수 추가\r\n        const matched = school.majors.some((major) =>\r\n          matchInterestToMajor(interest, major)\r\n        );\r\n\r\n        if (matched) {\r\n          score += weight;\r\n        }\r\n      });\r\n\r\n      // 지역 매칭 점수 계산\r\n      if (school.region === params.region) {\r\n        score += 5; // 지역 일치 시 추가 점수\r\n      }\r\n\r\n      return {\r\n        ...school,\r\n        matchScore: score,\r\n      };\r\n    });\r\n\r\n    // 점수가 0보다 큰 학교만 필터링하고 정렬\r\n    const matchedSchools = scoredSchools\r\n      .filter((school) => school.matchScore && school.matchScore > 0)\r\n      .sort((a, b) => {\r\n        // 1순위: 지역 일치 여부 (지역 일치가 먼저)\r\n        const aRegionMatch = a.region === params.region;\r\n        const bRegionMatch = b.region === params.region;\r\n\r\n        if (aRegionMatch && !bRegionMatch) return -1; // a가 지역 일치, b가 불일치 -> a가 앞\r\n        if (!aRegionMatch && bRegionMatch) return 1; // a가 지역 불일치, b가 일치 -> b가 앞\r\n\r\n        // 2순위: 지역이 같으면 점수 순으로 정렬\r\n        return (b.matchScore || 0) - (a.matchScore || 0);\r\n      });\r\n\r\n    return {\r\n      success: true,\r\n      schools: matchedSchools,\r\n    };\r\n  } catch (error) {\r\n    console.error(\"학교 매칭 오류:\", error);\r\n    return {\r\n      success: false,\r\n      error:\r\n        error instanceof Error\r\n          ? error.message\r\n          : \"알 수 없는 오류가 발생했습니다.\",\r\n    };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AACA;;;;;;;AA4BO,eAAe;IACpB,IAAI;QACF,+BAA+B;QAC/B,MAAM,WAAW,IAAA,yGAAI,EAAC,QAAQ,GAAG,IAAI,UAAU,QAAQ;QAEvD,gBAAgB;QAChB,IAAI;YACF,MAAM,aAAa,IAAA,6GAAY,EAAC;YAChC,MAAM,WAAW,uLAAS,CAAC,YAAY;gBAAE,MAAM;YAAS;YACxD,MAAM,YAAY,SAAS,UAAU,CAAC,EAAE;YACxC,MAAM,YAAY,SAAS,MAAM,CAAC,UAAU;YAC5C,MAAM,OAAO,wLAAU,CAAC,aAAa,CAAC;YAEtC,eAAe;YACf,MAAM,UAAoB,KACvB,GAAG,CAAC,CAAC,KAAK;gBACT,MAAM,aAAa,GAAG,CAAC,MAAM,IAAI;gBACjC,MAAM,aAAa,GAAG,CAAC,OAAO,IAAI;gBAClC,MAAM,kBAAkB,GAAG,CAAC,MAAM,IAAI;gBACtC,MAAM,YAAY,GAAG,CAAC,OAAO,IAAI;gBACjC,MAAM,WACJ,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,SAAS,IAAI,GAAG,CAAC,OAAO,IAAI;gBAEjD,cAAc;gBACd,MAAM,SAAS,iCAAiC;gBAEhD,WAAW;gBACX,MAAM,OAAyB,WAAW,QAAQ,CAChD,UAEE,UACA;gBAEJ,6CAA6C;gBAC7C,IAAI,qBAAqB;gBACzB,IACE,YACA,CAAC,SAAS,UAAU,CAAC,cACrB,CAAC,SAAS,UAAU,CAAC,aACrB;oBACA,qBAAqB,CAAC,OAAO,EAAE,UAAU;gBAC3C;gBAEA,MAAM,SAAiB;oBACrB,IAAI,CAAC,OAAO,EAAE,OAAO;oBACrB,MAAM;oBACN;oBACA;oBACA;oBACA,QAAQ,YAAY;oBACpB,YAAY,CAAC,iFAAiF,EAAE,mBAC9F,aACC;oBACH,UAAU,sBAAsB;gBAClC;gBAEA,OAAO;YACT,GACC,MAAM,CAAC,CAAC,SAAW,OAAO,IAAI,IAAI,OAAO,MAAM,GAAG,eAAe;YAEpE,OAAO;gBACL,SAAS;gBACT;YACF;QACF,EAAE,OAAO,WAAW;YAClB,OAAO;gBACL,SAAS;gBACT,OAAO,CAAC,gCAAgC,EAAE,UAAU;YACtD;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO;YACL,SAAS;YACT,OACE,iBAAiB,QACb,MAAM,OAAO,GACb;QACR;IACF;AACF;AAEA,eAAe;AACf,SAAS,iCAAiC,eAAuB;IAC/D,IAAI,CAAC,iBAAiB,OAAO;IAE7B,eAAe;IACf,0CAA0C;IAC1C,MAAM,YAAoC;QACxC,UAAU;QACV,UAAU;QACV,UAAU;QACV,UAAU;QACV,UAAU;QACV,UAAU;QACV,UAAU;QACV,YAAY;QACZ,QAAQ;QACR,YAAY;QACZ,SAAS;QACT,SAAS;QACT,YAAY;QACZ,SAAS;QACT,SAAS;QACT,SAAS;QACT,YAAY;IACd;IAEA,YAAY;IACZ,IAAI,SAAS,CAAC,gBAAgB,EAAE;QAC9B,OAAO,SAAS,CAAC,gBAAgB;IACnC;IAEA,WAAW;IACX,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,WAAY;QACpD,IAAI,gBAAgB,QAAQ,CAAC,IAAI,OAAO,CAAC,OAAO,MAAM;YACpD,OAAO;QACT;IACF;IAEA,wBAAwB;IACxB,OAAO;AACT;AAEA,0CAA0C;AAC1C,SAAS,YAAY,WAAmB;IACtC,IAAI,CAAC,aAAa,OAAO,EAAE;IAE3B,OAAO,YACJ,KAAK,CAAC,SACN,GAAG,CAAC,CAAC,QAAU,MAAM,IAAI,IACzB,MAAM,CAAC,CAAC,QAAU,MAAM,MAAM,GAAG;AACtC;AAGO,eAAe,aAAa,MAGlC;IACC,IAAI;QACF,YAAY;QACZ,MAAM,aAAa,MAAM;QAEzB,IAAI,CAAC,WAAW,OAAO,IAAI,CAAC,WAAW,OAAO,EAAE;YAC9C,OAAO;gBACL,SAAS;gBACT,OAAO,WAAW,KAAK,IAAI;YAC7B;QACF;QAEA,MAAM,UAAU,WAAW,OAAO;QAElC,WAAW;QACX,MAAM,gBAA0B,QAAQ,GAAG,CAAC,CAAC;YAC3C,IAAI,QAAQ;YAEZ,eAAe;YACf,OAAO,SAAS,CAAC,OAAO,CAAC,CAAC,UAAU;gBAClC,IAAI,CAAC,UAAU;gBAEf,MAAM,SAAS;oBAAC;oBAAG;oBAAG;iBAAE,CAAC,MAAM,EAAE,4BAA4B;gBAE7D,gCAAgC;gBAChC,MAAM,UAAU,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC,QAClC,mJAAqB,UAAU;gBAGjC,IAAI,SAAS;oBACX,SAAS;gBACX;YACF;YAEA,cAAc;YACd,IAAI,OAAO,MAAM,KAAK,OAAO,MAAM,EAAE;gBACnC,SAAS,GAAG,gBAAgB;YAC9B;YAEA,OAAO;gBACL,GAAG,MAAM;gBACT,YAAY;YACd;QACF;QAEA,yBAAyB;QACzB,MAAM,iBAAiB,cACpB,MAAM,CAAC,CAAC,SAAW,OAAO,UAAU,IAAI,OAAO,UAAU,GAAG,GAC5D,IAAI,CAAC,CAAC,GAAG;YACR,4BAA4B;YAC5B,MAAM,eAAe,EAAE,MAAM,KAAK,OAAO,MAAM;YAC/C,MAAM,eAAe,EAAE,MAAM,KAAK,OAAO,MAAM;YAE/C,IAAI,gBAAgB,CAAC,cAAc,OAAO,CAAC,GAAG,2BAA2B;YACzE,IAAI,CAAC,gBAAgB,cAAc,OAAO,GAAG,2BAA2B;YAExE,yBAAyB;YACzB,OAAO,CAAC,EAAE,UAAU,IAAI,CAAC,IAAI,CAAC,EAAE,UAAU,IAAI,CAAC;QACjD;QAEF,OAAO;YACL,SAAS;YACT,SAAS;QACX;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,aAAa;QAC3B,OAAO;YACL,SAAS;YACT,OACE,iBAAiB,QACb,MAAM,OAAO,GACb;QACR;IACF;AACF;;;IApNsB;IAuIA;;AAvIA,8WAAA;AAuIA,8WAAA"}},
    {"offset": {"line": 1114, "column": 0}, "map": {"version":3,"sources":["file:///C:/cording/landing-page-design/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {sendChatMessage as '60da9626967c432fb7b5f35c996fffe514b45031ed'} from 'ACTIONS_MODULE0'\nexport {collectNews as '00d17b4b1da97279cdc73a668fc1e8474570adec9b'} from 'ACTIONS_MODULE1'\nexport {getNews as '407f1564b5ff55eb1c9dc3eaa2df65efd22c87db84'} from 'ACTIONS_MODULE1'\nexport {submitWaitlistForm as '78a333388d3e2db9241a5de54a510b23b3813ec8e2'} from 'ACTIONS_MODULE2'\nexport {verifyLogin as '70d459a2e42df3de227639d653795394176f4096ee'} from 'ACTIONS_MODULE2'\nexport {matchSchools as '403c82b8bf08cb9ee7a7bf969703c2173e559fea76'} from 'ACTIONS_MODULE3'\n"],"names":[],"mappings":";AAAA;AACA;AAEA;AAEA"}}]
}